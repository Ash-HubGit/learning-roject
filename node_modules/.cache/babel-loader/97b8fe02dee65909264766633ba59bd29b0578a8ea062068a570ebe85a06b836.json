{"ast":null,"code":"import { RRule, DEFAULT_OPTIONS } from './rrule';\nimport { includes, isPresent, isArray, isNumber, toArray } from './helpers';\nimport { Weekday } from './weekday';\nimport dateutil from './dateutil';\nimport { DateWithZone } from './datewithzone';\nexport function optionsToString(options) {\n  var rrule = [];\n  var dtstart = '';\n  var keys = Object.keys(options);\n  var defaultKeys = Object.keys(DEFAULT_OPTIONS);\n  for (var i = 0; i < keys.length; i++) {\n    if (keys[i] === 'tzid') continue;\n    if (!includes(defaultKeys, keys[i])) continue;\n    var key = keys[i].toUpperCase();\n    var value = options[keys[i]];\n    var outValue = '';\n    if (!isPresent(value) || isArray(value) && !value.length) continue;\n    switch (key) {\n      case 'FREQ':\n        outValue = RRule.FREQUENCIES[options.freq];\n        break;\n      case 'WKST':\n        if (isNumber(value)) {\n          outValue = new Weekday(value).toString();\n        } else {\n          outValue = value.toString();\n        }\n        break;\n      case 'BYWEEKDAY':\n        /*\n          NOTE: BYWEEKDAY is a special case.\n          RRule() deconstructs the rule.options.byweekday array\n          into an array of Weekday arguments.\n          On the other hand, rule.origOptions is an array of Weekdays.\n          We need to handle both cases here.\n          It might be worth change RRule to keep the Weekdays.\n                   Also, BYWEEKDAY (used by RRule) vs. BYDAY (RFC)\n                   */\n        key = 'BYDAY';\n        outValue = toArray(value).map(function (wday) {\n          if (wday instanceof Weekday) {\n            return wday;\n          }\n          if (isArray(wday)) {\n            return new Weekday(wday[0], wday[1]);\n          }\n          return new Weekday(wday);\n        }).toString();\n        break;\n      case 'DTSTART':\n        dtstart = buildDtstart(value, options.tzid);\n        break;\n      case 'UNTIL':\n        outValue = dateutil.timeToUntilString(value, !options.tzid);\n        break;\n      default:\n        if (isArray(value)) {\n          var strValues = [];\n          for (var j = 0; j < value.length; j++) {\n            strValues[j] = String(value[j]);\n          }\n          outValue = strValues.toString();\n        } else {\n          outValue = String(value);\n        }\n    }\n    if (outValue) {\n      rrule.push([key, outValue]);\n    }\n  }\n  var rules = rrule.map(function (_a) {\n    var key = _a[0],\n      value = _a[1];\n    return \"\".concat(key, \"=\").concat(value.toString());\n  }).join(';');\n  var ruleString = '';\n  if (rules !== '') {\n    ruleString = \"RRULE:\".concat(rules);\n  }\n  return [dtstart, ruleString].filter(function (x) {\n    return !!x;\n  }).join('\\n');\n}\nfunction buildDtstart(dtstart, tzid) {\n  if (!dtstart) {\n    return '';\n  }\n  return 'DTSTART' + new DateWithZone(new Date(dtstart), tzid).toString();\n}","map":{"version":3,"mappings":"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","names":["RRule","DEFAULT_OPTIONS","includes","isPresent","isArray","isNumber","toArray","Weekday","dateutil","DateWithZone","optionsToString","options","rrule","dtstart","keys","Object","defaultKeys","i","length","key","toUpperCase","value","outValue","FREQUENCIES","freq","toString","map","wday","buildDtstart","tzid","timeToUntilString","strValues","j","String","push","rules","_a","join","ruleString","filter","x","Date"],"sources":["../../src/optionstostring.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module","externalDependencies":[]}